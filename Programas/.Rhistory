cat("Tasa mes 4 (centrada):", dif_centrada, "miles/mes\n")
cat("Tasa mes 7 (atrás):", dif_atras, "miles/mes\n")
# 2. Segunda derivada (aceleración) en puntos interiores
f2 <- numeric(length(usuarios))
for (i in 2:(length(usuarios)-1)) {
f2[i] <- (usuarios[i+1] - 2*usuarios[i] + usuarios[i-1]) / (h^2)
}
f2
cat("\nSegunda derivada (aceleración) por mes:\n")
print(data.frame(mes=mes, aceleracion=f2))
# 3. Interpretación
if (all(f2[2:6] > 0)) {
cat("\nLa aceleración es positiva → crecimiento acelerado.\n")
} else if (all(f2[2:6] < 0)) {
cat("\nLa aceleración es negativa → crecimiento desacelerado.\n")
} else {
cat("\nLa aceleración varía → crecimiento irregular.\n")
}
# Datos
epoca <- c(0,10,20,30,40,50)
loss  <- c(2.45, 1.82, 1.35, 1.08, 0.95, 0.89)
h <- 10
# Funciones para derivadas (usando h fijo = 10)
# Diferencia hacia adelante (para primer punto)
d_forward <- function(i) {
(loss[i+1] - loss[i]) / h
}
# Diferencia hacia atrás (para último punto)
d_backward <- function(i) {
(loss[i] - loss[i-1]) / h
}
# Diferencia centrada (para puntos interiores)
d_center <- function(i) {
(loss[i+1] - loss[i-1]) / (2*h)
}
# Segunda derivada centrada
d2_center <- function(i) {
(loss[i+1] - 2*loss[i] + loss[i-1]) / (h^2)
}
# Calcular derivadas en cada época
deriv <- numeric(length(loss))
for (i in seq_along(loss)) {
if (i == 1) deriv[i] <- d_forward(i)
else if (i == length(loss)) deriv[i] <- d_backward(i)
else deriv[i] <- d_center(i)
}
# Calcular segunda derivada en puntos interiores
d2 <- rep(NA, length(loss))
for (i in 2:(length(loss)-1)) {
d2[i] <- d2_center(i)
}
# Resultados pedidos:
cat("Derivadas (loss por época):\n")
print(data.frame(epoca=epoca, loss=loss, derivada=round(deriv, 5)))
cat("\nSegunda derivada (solo puntos interiores):\n")
print(data.frame(epoca=epoca, segunda_derivada=round(d2, 6)))
# 1) Tasa en época 20 (índice de época 3)
idx20 <- which(epoca == 20)
cat("\n1) f'(20) (centrada, h=10):", round(deriv[idx20], 5), " (loss/época)\n")
# 2) Segunda derivada en época 30
idx30 <- which(epoca == 30)
cat("2) f''(30):", round(d2[idx30], 6), " (loss/época^2)\n")
# Interpretación (impresa)
if (!is.na(d2[idx30])) {
if (d2[idx30] > 0) {
cat("   Interpretación: f''(30) > 0 → la magnitud de la pendiente se está reduciendo; la disminución del loss se está frenando (convergencia en curso).\n")
} else if (d2[idx30] < 0) {
cat("   Interpretación: f''(30) < 0 → la disminución se está acelerando.\n")
} else {
cat("   Interpretación: f''(30) ≈ 0 → curva cercana a lineal localmente.\n")
}
}
# 3) ¿En qué época |f'| < 0.01 ?
idx_crit <- which(abs(deriv) < 0.01)
if (length(idx_crit) > 0) {
cat("\n3) Épocas donde |f'| < 0.01:", epoca[idx_crit], "\n")
cat("   Primera época que cumple el criterio:", epoca[min(idx_crit)], "\n")
} else {
cat("\n3) No se alcanza |f'| < 0.01 en las épocas dadas.\n")
}
# 4) Estimación de loss en época 25 usando linearización en época 20:
t_target <- 25
t0 <- 20
f_t0 <- loss[which(epoca == t0)]
fprime_t0 <- deriv[which(epoca == t0)]
f25_est <- f_t0 + fprime_t0 * (t_target - t0)
cat("\n4) Estimación lineal (usando derivada en 20): f(25) ≈", round(f25_est, 4), "\n")
# Para comparación: interpolación lineal directa entre 20 y 30
f20 <- f_t0
f30 <- loss[which(epoca == 30)]
f25_lin_between <- f20 + (f30 - f20) * ( (t_target - 20) / (30 - 20) )
cat("   Interpolación lineal entre 20 y 30: f(25) ≈", round(f25_lin_between,4), "\n")
# Datos
dias <- c("Lun","Mar","Mié","Jue","Vie","Sáb","Dom")
ventas <- c(45, 52, 61, 58, 73, 89, 95)  # en $k
h <- 1
# 1) Primera derivada: adelante en primer punto, atrás en último, centrada en interiores
deriv <- numeric(length(ventas))
for (i in seq_along(ventas)) {
if (i == 1) {
deriv[i] <- (ventas[i+1] - ventas[i]) / h
} else if (i == length(ventas)) {
deriv[i] <- (ventas[i] - ventas[i-1]) / h
} else {
deriv[i] <- (ventas[i+1] - ventas[i-1]) / (2*h)
}
}
# 2) Segunda derivada (centrada) en puntos interiores
d2 <- rep(NA, length(ventas))
for (i in 2:(length(ventas)-1)) {
d2[i] <- (ventas[i+1] - 2*ventas[i] + ventas[i-1]) / (h^2)
}
# Identificar día con mayor aceleración positiva
idx_max_acc <- which.max(d2)  # returns first max (NA treated as -Inf)
# but ensure it's interior (non-NA)
if (is.na(d2[idx_max_acc]) || length(idx_max_acc) == 0) {
dia_max_acc <- NA
max_acc <- NA
} else {
dia_max_acc <- dias[idx_max_acc]
max_acc <- d2[idx_max_acc]
}
# 3) Magnitud de la caída el jueves (drop Mié -> Jue)
drop_jue <- ventas[4] - ventas[3]  # index 4 = Jue, 3 = Mié
# 4) Extrapolación lineal para Lunes siguiente usando derivada en Domingo
f_dom <- ventas[length(ventas)]
fprime_dom <- deriv[length(ventas)]
f_lun_sig <- f_dom + fprime_dom * 1
# Mostrar resultados
cat("Primera derivada (ventas $k/día) por día:\n")
print(data.frame(dia=dias, ventas=ventas, derivada=deriv))
cat("\nSegunda derivada (ventas $k/día^2) en puntos interiores:\n")
print(data.frame(dia=dias, segunda_derivada=d2))
cat("\nDía con mayor aceleración positiva:\n")
cat("  ", dia_max_acc, "con f'' =", max_acc, "\n")
cat("\nCaída en ventas Mié -> Jue: ", drop_jue, " $k (si es negativo, es caída)\n")
cat("\nProyección lunes siguiente (usando derivada en domingo):\n")
cat("  Ventas domingo =", f_dom, " $k\n")
cat("  Tasa domingo =", fprime_dom, " $k/día\n")
cat("  Estimación lunes siguiente =", f_lun_sig, " $k\n")
# Datos
x <- c(-3, -2, -1, 0, 1, 2, 3)
sigma <- c(0.0474, 0.1192, 0.2689, 0.5000, 0.7311, 0.8808, 0.9526)
h <- 1
# Indices helper
idx <- function(val) which(x == val)
# 1) Derivada centrada para x = 0, -2, 2
deriv_centered <- function(xval) {
i <- idx(xval)
# asumiendo que xval tiene vecinos (x-h) y (x+h) disponibles
(sigma[i + 1] - sigma[i - 1]) / (2 * h)
}
d0_num <- deriv_centered(0)
dminus2_num <- deriv_centered(-2)
d2_num <- deriv_centered(2)
# 2) Derivada analítica sigma*(1-sigma)
d_analytic <- sigma * (1 - sigma)
d0_ana <- d_analytic[idx(0)]
dminus2_ana <- d_analytic[idx(-2)]
d2_ana <- d_analytic[idx(2)]
# 3) Errores
abs_err_0 <- d0_num - d0_ana
rel_err_0 <- abs_err_0 / d0_ana * 100
abs_err_m2 <- dminus2_num - dminus2_ana
rel_err_m2 <- abs_err_m2 / dminus2_ana * 100
abs_err_2 <- d2_num - d2_ana
rel_err_2 <- abs_err_2 / d2_ana * 100
# Mostrar resultados
cat("Resultados (h = 1):\n\n")
cat("x = 0:\n")
cat("  derivada num (centrada) =", d0_num, "\n")
cat("  derivada analítica      =", d0_ana, "\n")
cat("  error absoluto =", abs_err_0, ", error relativo (%) =", rel_err_0, "\n\n")
cat("x = -2:\n")
cat("  derivada num (centrada) =", dminus2_num, "\n")
cat("  derivada analítica      =", dminus2_ana, "\n")
cat("  error absoluto =", abs_err_m2, ", error relativo (%) =", rel_err_m2, "\n\n")
cat("x = 2:\n")
cat("  derivada num (centrada) =", d2_num, "\n")
cat("  derivada analítica      =", d2_ana, "\n")
cat("  error absoluto =", abs_err_2, ", error relativo (%) =", rel_err_2, "\n\n")
# Tabla resumen
res <- data.frame(
x = x,
sigma = sigma,
deriv_analitica = round(d_analytic, 8),
deriv_centrada = c(NA, dminus2_num, NA, d0_num, NA, d2_num, NA)
)
cat("Tabla resumen:\n")
print(res)
# Recomendación sobre h (comentario)
cat("\nNota: si puedes evaluar sigma(x) analíticamente, usa h pequeño (p.ej. 1e-5) o mejor aún usa la derivada analítica.\n")
setwd("E:/Universidad/Ing. Estadística e Informática/IV Semestre/Programación numérica/Git/Libro/Programas")
# Datos
mes <- 1:7
usuarios <- c(10, 15, 23, 34, 48, 65, 85)
h <- 1
# 1. Derivadas (tasa de crecimiento)
# Diferencia adelante, atrás y centrada
dif_adelante <- (usuarios[2] - usuarios[1]) / h
dif_atras <- (usuarios[7] - usuarios[6]) / h
dif_centrada <- (usuarios[5] - usuarios[3]) / (2*h)
cat("Tasa mes 1 (adelante):", dif_adelante, "miles/mes\n")
cat("Tasa mes 4 (centrada):", dif_centrada, "miles/mes\n")
cat("Tasa mes 7 (atrás):", dif_atras, "miles/mes\n")
# 2. Segunda derivada (aceleración) en puntos interiores
f2 <- numeric(length(usuarios))
for (i in 2:(length(usuarios)-1)) {
f2[i] <- (usuarios[i+1] - 2*usuarios[i] + usuarios[i-1]) / (h^2)
}
f2
cat("\nSegunda derivada (aceleración) por mes:\n")
print(data.frame(mes=mes, aceleracion=f2))
# 3. Interpretación
if (all(f2[2:6] > 0)) {
cat("\nLa aceleración es positiva → crecimiento acelerado.\n")
} else if (all(f2[2:6] < 0)) {
cat("\nLa aceleración es negativa → crecimiento desacelerado.\n")
} else {
cat("\nLa aceleración varía → crecimiento irregular.\n")
}
# Datos
epoca <- c(0,10,20,30,40,50)
loss  <- c(2.45, 1.82, 1.35, 1.08, 0.95, 0.89)
h <- 10
# Funciones para derivadas (usando h fijo = 10)
# Diferencia hacia adelante (para primer punto)
d_forward <- function(i) {
(loss[i+1] - loss[i]) / h
}
# Diferencia hacia atrás (para último punto)
d_backward <- function(i) {
(loss[i] - loss[i-1]) / h
}
# Diferencia centrada (para puntos interiores)
d_center <- function(i) {
(loss[i+1] - loss[i-1]) / (2*h)
}
# Segunda derivada centrada
d2_center <- function(i) {
(loss[i+1] - 2*loss[i] + loss[i-1]) / (h^2)
}
# Calcular derivadas en cada época
deriv <- numeric(length(loss))
for (i in seq_along(loss)) {
if (i == 1) deriv[i] <- d_forward(i)
else if (i == length(loss)) deriv[i] <- d_backward(i)
else deriv[i] <- d_center(i)
}
# Calcular segunda derivada en puntos interiores
d2 <- rep(NA, length(loss))
for (i in 2:(length(loss)-1)) {
d2[i] <- d2_center(i)
}
# Resultados pedidos:
cat("Derivadas (loss por época):\n")
print(data.frame(epoca=epoca, loss=loss, derivada=round(deriv, 5)))
cat("\nSegunda derivada (solo puntos interiores):\n")
print(data.frame(epoca=epoca, segunda_derivada=round(d2, 6)))
# 1) Tasa en época 20 (índice de época 3)
idx20 <- which(epoca == 20)
cat("\n1) f'(20) (centrada, h=10):", round(deriv[idx20], 5), " (loss/época)\n")
# 2) Segunda derivada en época 30
idx30 <- which(epoca == 30)
cat("2) f''(30):", round(d2[idx30], 6), " (loss/época^2)\n")
# Interpretación (impresa)
if (!is.na(d2[idx30])) {
if (d2[idx30] > 0) {
cat("   Interpretación: f''(30) > 0 → la magnitud de la pendiente se está reduciendo; la disminución del loss se está frenando (convergencia en curso).\n")
} else if (d2[idx30] < 0) {
cat("   Interpretación: f''(30) < 0 → la disminución se está acelerando.\n")
} else {
cat("   Interpretación: f''(30) ≈ 0 → curva cercana a lineal localmente.\n")
}
}
# 3) ¿En qué época |f'| < 0.01 ?
idx_crit <- which(abs(deriv) < 0.01)
if (length(idx_crit) > 0) {
cat("\n3) Épocas donde |f'| < 0.01:", epoca[idx_crit], "\n")
cat("   Primera época que cumple el criterio:", epoca[min(idx_crit)], "\n")
} else {
cat("\n3) No se alcanza |f'| < 0.01 en las épocas dadas.\n")
}
# 4) Estimación de loss en época 25 usando linearización en época 20:
t_target <- 25
t0 <- 20
f_t0 <- loss[which(epoca == t0)]
fprime_t0 <- deriv[which(epoca == t0)]
f25_est <- f_t0 + fprime_t0 * (t_target - t0)
cat("\n4) Estimación lineal (usando derivada en 20): f(25) ≈", round(f25_est, 4), "\n")
# Para comparación: interpolación lineal directa entre 20 y 30
f20 <- f_t0
f30 <- loss[which(epoca == 30)]
f25_lin_between <- f20 + (f30 - f20) * ( (t_target - 20) / (30 - 20) )
cat("   Interpolación lineal entre 20 y 30: f(25) ≈", round(f25_lin_between,4), "\n")
# Datos
dias <- c("Lun","Mar","Mié","Jue","Vie","Sáb","Dom")
ventas <- c(45, 52, 61, 58, 73, 89, 95)  # en $k
h <- 1
# 1) Primera derivada: adelante en primer punto, atrás en último, centrada en interiores
deriv <- numeric(length(ventas))
for (i in seq_along(ventas)) {
if (i == 1) {
deriv[i] <- (ventas[i+1] - ventas[i]) / h
} else if (i == length(ventas)) {
deriv[i] <- (ventas[i] - ventas[i-1]) / h
} else {
deriv[i] <- (ventas[i+1] - ventas[i-1]) / (2*h)
}
}
# 2) Segunda derivada (centrada) en puntos interiores
d2 <- rep(NA, length(ventas))
for (i in 2:(length(ventas)-1)) {
d2[i] <- (ventas[i+1] - 2*ventas[i] + ventas[i-1]) / (h^2)
}
# Identificar día con mayor aceleración positiva
idx_max_acc <- which.max(d2)  # returns first max (NA treated as -Inf)
# but ensure it's interior (non-NA)
if (is.na(d2[idx_max_acc]) || length(idx_max_acc) == 0) {
dia_max_acc <- NA
max_acc <- NA
} else {
dia_max_acc <- dias[idx_max_acc]
max_acc <- d2[idx_max_acc]
}
# 3) Magnitud de la caída el jueves (drop Mié -> Jue)
drop_jue <- ventas[4] - ventas[3]  # index 4 = Jue, 3 = Mié
# 4) Extrapolación lineal para Lunes siguiente usando derivada en Domingo
f_dom <- ventas[length(ventas)]
fprime_dom <- deriv[length(ventas)]
f_lun_sig <- f_dom + fprime_dom * 1
# Mostrar resultados
cat("Primera derivada (ventas $k/día) por día:\n")
print(data.frame(dia=dias, ventas=ventas, derivada=deriv))
cat("\nSegunda derivada (ventas $k/día^2) en puntos interiores:\n")
print(data.frame(dia=dias, segunda_derivada=d2))
cat("\nDía con mayor aceleración positiva:\n")
cat("  ", dia_max_acc, "con f'' =", max_acc, "\n")
cat("\nCaída en ventas Mié -> Jue: ", drop_jue, " $k (si es negativo, es caída)\n")
cat("\nProyección lunes siguiente (usando derivada en domingo):\n")
cat("  Ventas domingo =", f_dom, " $k\n")
cat("  Tasa domingo =", fprime_dom, " $k/día\n")
cat("  Estimación lunes siguiente =", f_lun_sig, " $k\n")
# Datos
x <- c(-3, -2, -1, 0, 1, 2, 3)
sigma <- c(0.0474, 0.1192, 0.2689, 0.5000, 0.7311, 0.8808, 0.9526)
h <- 1
# Indices helper
idx <- function(val) which(x == val)
# 1) Derivada centrada para x = 0, -2, 2
deriv_centered <- function(xval) {
i <- idx(xval)
# asumiendo que xval tiene vecinos (x-h) y (x+h) disponibles
(sigma[i + 1] - sigma[i - 1]) / (2 * h)
}
d0_num <- deriv_centered(0)
dminus2_num <- deriv_centered(-2)
d2_num <- deriv_centered(2)
# 2) Derivada analítica sigma*(1-sigma)
d_analytic <- sigma * (1 - sigma)
d0_ana <- d_analytic[idx(0)]
dminus2_ana <- d_analytic[idx(-2)]
d2_ana <- d_analytic[idx(2)]
# 3) Errores
abs_err_0 <- d0_num - d0_ana
rel_err_0 <- abs_err_0 / d0_ana * 100
abs_err_m2 <- dminus2_num - dminus2_ana
rel_err_m2 <- abs_err_m2 / dminus2_ana * 100
abs_err_2 <- d2_num - d2_ana
rel_err_2 <- abs_err_2 / d2_ana * 100
# Mostrar resultados
cat("Resultados (h = 1):\n\n")
cat("x = 0:\n")
cat("  derivada num (centrada) =", d0_num, "\n")
cat("  derivada analítica      =", d0_ana, "\n")
cat("  error absoluto =", abs_err_0, ", error relativo (%) =", rel_err_0, "\n\n")
cat("x = -2:\n")
cat("  derivada num (centrada) =", dminus2_num, "\n")
cat("  derivada analítica      =", dminus2_ana, "\n")
cat("  error absoluto =", abs_err_m2, ", error relativo (%) =", rel_err_m2, "\n\n")
cat("x = 2:\n")
cat("  derivada num (centrada) =", d2_num, "\n")
cat("  derivada analítica      =", d2_ana, "\n")
cat("  error absoluto =", abs_err_2, ", error relativo (%) =", rel_err_2, "\n\n")
# Tabla resumen
res <- data.frame(
x = x,
sigma = sigma,
deriv_analitica = round(d_analytic, 8),
deriv_centrada = c(NA, dminus2_num, NA, d0_num, NA, d2_num, NA)
)
cat("Tabla resumen:\n")
print(res)
# Recomendación sobre h (comentario)
cat("\nNota: si puedes evaluar sigma(x) analíticamente, usa h pequeño (p.ej. 1e-5) o mejor aún usa la derivada analítica.\n")
# Código R para calcular automáticamente lo anterior
# Datos
hora <- 0:7
latencia <- c(120, 125, 128, 135, 280, 290, 275, 155)
h <- 1
# 1) Primera derivada: adelante, centrada, atrás
fprime <- numeric(length(latencia))
for (i in seq_along(latencia)) {
if (i == 1) {
fprime[i] <- (latencia[i+1] - latencia[i]) / h          # forward
} else if (i == length(latencia)) {
fprime[i] <- (latencia[i] - latencia[i-1]) / h          # backward
} else {
fprime[i] <- (latencia[i+1] - latencia[i-1]) / (2*h)    # centered
}
}
# 2) Segunda derivada centrada (puntos interiores)
f2 <- rep(NA, length(latencia))
for (i in 2:(length(latencia)-1)) {
f2[i] <- (latencia[i+1] - 2*latencia[i] + latencia[i-1]) / (h^2)
}
# 3) Magnitud salto 3->4
salto_3_4 <- latencia[5] - latencia[4]  # indices: hora 4 is index 5, hora 3 is index 4
# 4) Tasas de recuperación (a partir de la hora 6)
idx6 <- which(hora == 6)
tasa_recuperacion_cent <- fprime[idx6]
# derivada entre 6->7 (forward from 6 or backward at 7)
tasa_6_7 <- (latencia[8] - latencia[7]) / h  # index 8=hora7, 7=hora6
# 5) Detección de anomalías: |f'| > 50 ms/h
umbral <- 50
anomalias_idx <- which(abs(fprime) > umbral)
anomalias_horas <- hora[anomalias_idx]
# Imprimir resultados
cat("Primera derivada f' (ms/h) por hora:\n")
print(data.frame(hora=hora, latencia=latencia, fprime=round(fprime,4)))
cat("\nSegunda derivada f'' (ms/h^2) en puntos interiores:\n")
print(data.frame(hora=hora, f2=f2))
cat("\nSalto brusco 3->4 (ms):", salto_3_4, "\n")
cat("\nTasa de recuperación (hora 6, centrada):", tasa_recuperacion_cent, "ms/h\n")
cat("Tasa entre 6->7:", tasa_6_7, "ms/h\n")
if (length(anomalias_idx) > 0) {
cat("\nAnomalías detectadas (|f'| >", umbral, "ms/h) en horas:", anomalias_horas, "\n")
} else {
cat("\nNo se detectaron anomalías con el umbral dado.\n")
}
# Código R: cálculo automático de derivadas y decisiones
gasto <- c(0, 5, 10, 15, 20, 25)   # en $k
conv  <- c(2.1, 3.8, 5.2, 6.1, 6.7, 7.0)  # en %
h <- 5  # en $k
# 1) Derivadas (ROI marginal) - forward/back/centered
deriv <- numeric(length(conv))
for (i in seq_along(conv)) {
if (i == 1) {
deriv[i] <- (conv[i+1] - conv[i]) / h    # forward
} else if (i == length(conv)) {
deriv[i] <- (conv[i] - conv[i-1]) / h    # backward
} else {
deriv[i] <- (conv[i+1] - conv[i-1]) / (2*h)  # centered
}
}
# 2) Segunda derivada centrada (interiores)
d2 <- rep(NA, length(conv))
for (i in 2:(length(conv)-1)) {
d2[i] <- (conv[i+1] - 2*conv[i] + conv[i-1]) / (h^2)
}
# 3) ¿Dónde f'(x) > 0.2 % por $1k?
idx_gt_02 <- which(deriv > 0.2)
gasto_gt_02 <- gasto[idx_gt_02]
# punto aproximado donde f'(x)=0.2 (lineal entre 10 y 15 si desea precisión)
d10 <- deriv[which(gasto==10)]
d15 <- deriv[which(gasto==15)]
if (d10 != d15) {
frac <- (d10 - 0.2) / (d10 - d15)
x_threshold <- 10 + frac * (15 - 10)  # en $k
} else {
x_threshold <- NA
}
# Impresión de resultados
cat("Gasto ($k)  :", gasto, "\n")
cat("Conversion % :", conv, "\n\n")
cat("ROI marginal f' (% per $1k):\n")
print(round(deriv, 4))
cat("\nSegunda derivada (interiores) f'' (% per ($1k)^2):\n")
print(round(d2, 5))
cat("\nPuntos donde f' > 0.2 (% per $1k):", gasto_gt_02, "\n")
cat("Umbral f'(x)=0.2 ocurre aproximadamente en gasto = ", round(x_threshold, 3), " $k\n\n")
# Recomendación basada en derivadas
cat("Interpretación:\n")
cat("- f'(25) =", round(deriv[length(deriv)],4), "%/ $1k  (marginal positivo pero bajo)\n")
cat("- f'' en interiores (ej. f''(15) =", round(d2[which(gasto==15)],5), ") indica rendimientos decrecientes\n")
cat("--> Matemáticamente no conviene aumentar demasiado el gasto más allá de 25k si la meta es obtener conversion % por dolar adicional.\n")
# Datos
tiempo <- 0:7
temp <- c(20.1, 20.3, 20.8, 21.5, 22.6, 24.2, 26.1, 28.5)
h <- 1
# 1. Primera derivada (diferencias finitas)
vel <- numeric(length(temp))
for (i in seq_along(temp)) {
if (i == 1) vel[i] <- (temp[i+1] - temp[i]) / h
else if (i == length(temp)) vel[i] <- (temp[i] - temp[i-1]) / h
else vel[i] <- (temp[i+1] - temp[i-1]) / (2*h)
}
# 2. Segunda derivada
acc <- rep(NA, length(temp))
for (i in 2:(length(temp)-1)) {
acc[i] <- (temp[i+1] - 2*temp[i] + temp[i-1]) / (h^2)
}
# 3. Alertas (cuando velocidad > 0.8 °C/s)
alerta <- tiempo[vel > 0.8]
# 4. Normalización min-max
minmax <- function(x) (x - min(x, na.rm=TRUE)) / (max(x, na.rm=TRUE) - min(x, na.rm=TRUE))
vel_norm <- minmax(vel)
acc_norm <- minmax(acc)
# Mostrar resultados
df <- data.frame(tiempo, temp, vel, acc, vel_norm, acc_norm)
print(round(df, 3))
cat("\nMomentos con alerta (>0.8°C/s):", alerta, "segundos\n")
